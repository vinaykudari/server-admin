{"version":3,"sources":["../src/index.ts","../src/routes/logs.ts","../src/services/logsService.ts","../src/utils/paths.ts"],"sourcesContent":["import path from \"node:path\";\n\nimport express from \"express\";\n\nimport logsRouter from \"./routes/logs.js\";\nimport { clientDistPath } from \"./utils/paths.js\";\n\nconst app = express();\nconst port = Number(process.env.PORT ?? 4175);\n\napp.get(\"/api/health\", (_req, res) => {\n  res.json({ status: \"ok\" });\n});\n\napp.use(\"/api\", logsRouter);\n\napp.use(express.static(clientDistPath));\n\napp.get(\"*\", (_req, res) => {\n  res.sendFile(path.join(clientDistPath, \"index.html\"));\n});\n\napp.listen(port, () => {\n  console.log(`Server admin app listening on port ${port}`);\n});\n","import type { Request, Response } from \"express\";\nimport { Router } from \"express\";\n\nimport { getLogs } from \"../services/logsService.js\";\n\nconst router = Router();\n\nrouter.get(\"/logs\", async (_req: Request, res: Response) => {\n  try {\n    const payload = await getLogs();\n    res.json(payload);\n  } catch (error) {\n    const message = error instanceof Error ? error.message : \"Unknown error\";\n    res.status(500).json({ error: message });\n  }\n});\n\nexport default router;\n","import fs from \"node:fs/promises\";\n\nimport { runbookPath, tasksPath } from \"../utils/paths.js\";\n\nexport type LogDocument = {\n  name: \"RUNBOOK\" | \"TASKS\";\n  path: string;\n  content: string;\n  updatedAt: string;\n};\n\nexport type LogsPayload = {\n  runbook: LogDocument;\n  tasks: LogDocument;\n};\n\nconst readDoc = async (name: LogDocument[\"name\"], path: string): Promise<LogDocument> => {\n  const stat = await fs.stat(path);\n  const content = await fs.readFile(path, \"utf-8\");\n\n  return {\n    name,\n    path,\n    content,\n    updatedAt: stat.mtime.toISOString()\n  };\n};\n\nexport const getLogs = async (): Promise<LogsPayload> => {\n  const [runbook, tasks] = await Promise.all([\n    readDoc(\"RUNBOOK\", runbookPath),\n    readDoc(\"TASKS\", tasksPath)\n  ]);\n\n  return { runbook, tasks };\n};\n","import path from \"node:path\";\nimport { fileURLToPath } from \"node:url\";\n\nexport const workspaceRoot = process.env.WORKSPACE_ROOT ?? \"/root/.openclaw/workspace\";\n\nexport const runbookPath = path.join(workspaceRoot, \"RUNBOOK.md\");\nexport const tasksPath = path.join(workspaceRoot, \"TASKS.md\");\n\nconst currentFile = fileURLToPath(import.meta.url);\nconst currentDir = path.dirname(currentFile);\n\nexport const clientDistPath =\n  process.env.CLIENT_DIST_PATH ?? path.resolve(currentDir, \"../../client/dist\");\n"],"mappings":"AAAA,OAAOA,MAAU,OAEjB,OAAOC,MAAa,UCDpB,OAAS,UAAAC,MAAc,UCDvB,OAAOC,MAAQ,cCAf,OAAOC,MAAU,OACjB,OAAS,iBAAAC,MAAqB,MAEvB,IAAMC,EAAgB,QAAQ,IAAI,gBAAkB,4BAE9CC,EAAcH,EAAK,KAAKE,EAAe,YAAY,EACnDE,EAAYJ,EAAK,KAAKE,EAAe,UAAU,EAEtDG,EAAcJ,EAAc,YAAY,GAAG,EAC3CK,EAAaN,EAAK,QAAQK,CAAW,EAE9BE,EACX,QAAQ,IAAI,kBAAoBP,EAAK,QAAQM,EAAY,mBAAmB,EDI9E,IAAME,EAAU,MAAOC,EAA2BC,IAAuC,CACvF,IAAMC,EAAO,MAAMC,EAAG,KAAKF,CAAI,EACzBG,EAAU,MAAMD,EAAG,SAASF,EAAM,OAAO,EAE/C,MAAO,CACL,KAAAD,EACA,KAAAC,EACA,QAAAG,EACA,UAAWF,EAAK,MAAM,YAAY,CACpC,CACF,EAEaG,EAAU,SAAkC,CACvD,GAAM,CAACC,EAASC,CAAK,EAAI,MAAM,QAAQ,IAAI,CACzCR,EAAQ,UAAWS,CAAW,EAC9BT,EAAQ,QAASU,CAAS,CAC5B,CAAC,EAED,MAAO,CAAE,QAAAH,EAAS,MAAAC,CAAM,CAC1B,ED9BA,IAAMG,EAASC,EAAO,EAEtBD,EAAO,IAAI,QAAS,MAAOE,EAAeC,IAAkB,CAC1D,GAAI,CACF,IAAMC,EAAU,MAAMC,EAAQ,EAC9BF,EAAI,KAAKC,CAAO,CAClB,OAASE,EAAO,CACd,IAAMC,EAAUD,aAAiB,MAAQA,EAAM,QAAU,gBACzDH,EAAI,OAAO,GAAG,EAAE,KAAK,CAAE,MAAOI,CAAQ,CAAC,CACzC,CACF,CAAC,EAED,IAAOC,EAAQR,EDVf,IAAMS,EAAMC,EAAQ,EACdC,EAAO,OAAO,QAAQ,IAAI,MAAQ,IAAI,EAE5CF,EAAI,IAAI,cAAe,CAACG,EAAMC,IAAQ,CACpCA,EAAI,KAAK,CAAE,OAAQ,IAAK,CAAC,CAC3B,CAAC,EAEDJ,EAAI,IAAI,OAAQK,CAAU,EAE1BL,EAAI,IAAIC,EAAQ,OAAOK,CAAc,CAAC,EAEtCN,EAAI,IAAI,IAAK,CAACG,EAAMC,IAAQ,CAC1BA,EAAI,SAASG,EAAK,KAAKD,EAAgB,YAAY,CAAC,CACtD,CAAC,EAEDN,EAAI,OAAOE,EAAM,IAAM,CACrB,QAAQ,IAAI,sCAAsCA,CAAI,EAAE,CAC1D,CAAC","names":["path","express","Router","fs","path","fileURLToPath","workspaceRoot","runbookPath","tasksPath","currentFile","currentDir","clientDistPath","readDoc","name","path","stat","fs","content","getLogs","runbook","tasks","runbookPath","tasksPath","router","Router","_req","res","payload","getLogs","error","message","logs_default","app","express","port","_req","res","logs_default","clientDistPath","path"]}